<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>Container ç®¡ç† (ç­†è¨˜ ä¸€) - Monolithic to Microservice</title>
      <link href="2020/10/09/Container%20%E7%AE%A1%E7%90%86%20(%E4%B8%80)%20-%20Monolithic%20to%20Microservice/"/>
      <url>2020/10/09/Container%20%E7%AE%A1%E7%90%86%20(%E4%B8%80)%20-%20Monolithic%20to%20Microservice/</url>
      
        <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>åœ¨ç©è½‰ Kubernetes é€™å€‹ç‚«ç ²çš„æŠ€è¡“ä¹‹å‰ï¼Œæˆ‘å€‘å¿…é ˆè¦å…ˆç­è§£å®ƒåˆ°åº•åœ¨è§£æ±ºä»€éº¼æ¨£çš„å•é¡Œä»¥åŠæ•´å€‹ä¾†é¾å»è„ˆã€‚è©²æ–‡ç« ä¸»è¦å…ˆæ¢è¨ Monlithic ä½œç‚ºæ­·å²èƒŒæ™¯ä¸‹å¸¸ç”¨çš„é–‹ç™¼æ¨¡å¼ï¼Œä¸€ç›´åˆ°ä½¿ç”¨ Microservice æ™‚é‡åˆ°çš„è™•å¢ƒä»¥åŠç›¸å°æ‡‰å·¥å…·çš„æ­é…ï¼Œä¾†å‘ˆç¾åœ¨æ‡‰ç”¨ç¨‹å¼å¾®æœå‹™åŒ–çš„æƒ…å¢ƒåº•ä¸‹å¦‚ä½•ç®¡ç†å¤§é‡çš„å¾®æœå‹™ã€‚</p><h3 id="Monolithic-çš„ç¼ºé»"><a href="#Monolithic-çš„ç¼ºé»" class="headerlink" title="Monolithic çš„ç¼ºé»"></a>Monolithic çš„ç¼ºé»</h3><ol><li>éš¨æ™‚é–“è€Œè®Šè‚¥å¤§ä¸”è¤‡é›œï¼Œè»Ÿé«”é›£ä»¥é‡æ§‹ã€‚åœ¨é™¤éŒ¯æ™‚ä¹Ÿé›£ä»¥å°‹æ‰¾ã€‚</li><li>ä¸èƒ½ä¾æ“šä¸åŒæœå‹™çš„æµé‡éœ€æ±‚ä¾† <strong>æ°´å¹³æ“´å±•</strong> ï¼Œè€Œæ˜¯ä¸€æ¬¡éƒ¨ç½²æ•´é«”æ”¯æ‡‰ç”¨ç¨‹å¼é€ æˆä¸å¿…è¦çš„è³‡æºæˆæœ¬å¢åŠ ã€‚</li></ol><h3 id="Microservice-çš„å„ªé»"><a href="#Microservice-çš„å„ªé»" class="headerlink" title="Microservice çš„å„ªé»"></a>Microservice çš„å„ªé»</h3><ol><li>é–‹ç™¼ä¸Šçš„å¯ä»¥åšåˆ°è‰¯å¥½çš„<strong>è§£éš… (Decouple)</strong></li><li>æ“æœ‰æ°´å¹³æ“´å±•çš„èƒ½åŠ› (ä¾ç„¶éœ€è¦çœ‹æƒ…å¢ƒ)</li><li>ä¸åŒçš„å¾®æœå‹™å¯ä»¥ç¨ç«‹ç¶­è­·éƒ¨ç½²</li></ol><p><img src="https://i.imgur.com/enSwKWw.png"><br><img src="https://i.imgur.com/fSUyZRB.png"></p><h2 id="å›°é›£é»"><a href="#å›°é›£é»" class="headerlink" title="å›°é›£é»"></a>å›°é›£é»</h2><ul><li><p>ğŸ˜‚ é‡æ–°æŠ½è±¡è»Ÿé«”æ¶æ§‹</p></li><li><p>ğŸ˜‚ <strong>API è¦è®Šæˆ stateless</strong> (*è¨»è§£ã„§)</p></li><li><p>ğŸ˜ ç”±æ–¼ç³»çµ±è®Šå¾—é¾å¤§ä¸”è¤‡é›œï¼Œæ‰€ä»¥åœ¨é™¤éŒ¯ä¸Šæœƒæ›´åŠ å›°é›£ <a href="https://zipkin.io/">Zipkin</a></p></li><li><p>ğŸ˜ğŸ˜ ç•¶æœ‰å¤§é‡çš„å¾®æœå‹™ <strong>ç›¸äº’ä¾è³´</strong> æ™‚æœƒè®“ä½ è¦å»æ±ºå®šèª°å»è¦ä¸€èµ·è¢«éƒ¨ç½²</p></li><li><p>ğŸ˜ å¾®æœå‹™é€ æˆç’°å¢ƒçš„å¤šæ¨£æ€§æ›´é«˜ï¼Œåœ¨é–‹ç™¼å’Œéƒ¨ç½²ç’°å¢ƒä¸Šæ›´ä¸å®¹æ˜“ç¶­è­·</p></li><li><p>ğŸ˜ ç’°å¢ƒéœ€æ±‚çš„ä¸åŒï¼Œç¨‹å¼æƒ³è¦ä¸åŒç‰ˆæœ¬çš„ shared libs</p></li></ul><p>è¨»è§£ä¸€ï¼š</p><ol><li>ç•¶ä½ çš„æœå‹™ä¸éœ€è¦åœ¨å…§éƒ¨ç¶­æŒè«‹æ±‚ä¹‹é–“çš„ç‹€æ…‹æ™‚å°±æ˜¯ <strong>stateless service</strong> ï¼Œåä¹‹å°±æ˜¯ <strong>stateful service</strong> (<strong>éœ€è¦é–‹ sticky session</strong>)ã€‚</li><li>å¾®æœå‹™æ‡‰è©²å°‡ç‹€æ…‹è³‡è¨Šå„²å­˜åœ¨å¤–éƒ¨è€Œéå…§éƒ¨ï¼Œé€™æ‰æœ‰åˆ©æ–¼æœå‹™çš„æ“´å±•ã€‚</li></ol><p><a href="https://stackoverflow.com/questions/58696684/stateless-vs-stateful-microservices">stateful vs stateless</a></p><h2 id="è§£æ±º"><a href="#è§£æ±º" class="headerlink" title="è§£æ±º"></a>è§£æ±º</h2><ul><li><p>ğŸ˜‚ ä¾è³´è»Ÿé«”åœ˜éšŠçš„ç¶“é©—è¨­è¨ˆ</p></li><li><p>ğŸ˜ æœå‹™çš„<a href="https://www.fiorano.com/blogs/microservices">é¡†ç²’åº¦(Granularity)</a>æ‡‰è©²ä»¥ç¨ç«‹çš„æ¥­å‹™é‚è¼¯ä¾†è§£æ±ºä¹‹é–“å›  <strong>ç›¸äº’ä¾è³´</strong> å°è‡´ <strong>é™¤éŒ¯å›°é›£</strong> çš„å•é¡Œ</p></li><li><p>ğŸ˜ <strong>We ease the pain with the help of docker and kubernetes.</strong></p></li></ul><h1 id="ä»‹ç´¹"><a href="#ä»‹ç´¹" class="headerlink" title="ä»‹ç´¹"></a>ä»‹ç´¹</h1><p><strong>å› æ‡‰å¤§é‡å®¹å™¨éƒ¨ç½²ç®¡ç†çš„å›°é›£ï¼Œæ‰€ä»¥æ‰éœ€è¦æœ‰ä¸€å€‹å®¹å™¨ç®¡ç†å·¥å…·ä¾†è§£æ±º</strong> (e.g. æŸå…¬å¸æ¸¬è©¦ç”¨ 8000 å€‹ container)</p><h2 id="Container-management-solutions"><a href="#Container-management-solutions" class="headerlink" title="Container management solutions"></a>Container management solutions</h2><ul><li><strong>docker-compose</strong> <ul><li>é©ç”¨åœ¨ <strong>å–®ç¯€é»</strong> çš„ç’°å¢ƒä¸Šï¼Œå¯ä»¥å¿«é€Ÿéƒ¨ç½²å¤šå€‹å®¹å™¨ã€‚</li></ul></li><li><strong>openshift</strong> <ul><li><strong>now base on kubernetes</strong></li><li>red hat cloud è¼ƒä¸æœ‰å</li><li><img src="https://i.imgur.com/JegIerL.png" width="450" height="450" /></li></ul></li><li><strong>kubernetes</strong><ul><li>åœ¨ public cloud å¾—åˆ°æœ€å®Œæ•´çš„æ”¯æ´</li><li>å„¼ç„¶æˆç‚º Container management çš„æ¨™æº– </li></ul></li><li><strong>minikube</strong><ul><li>local çš„å–®ç¯€é» k8sã€‚<strong>é©åˆæ‹¿ä¾†ç·´ç¿’</strong></li></ul></li><li><strong>k3s</strong> (é–¹å‰²)<ul><li>æ²’æœ‰ add-ons ï¼Œä¸å¤ å½ˆæ€§</li></ul></li><li><strong>microk8s</strong><ul><li>æœ‰ add-ons ï¼Œå¯å½ˆæ€§æŠ½æ›ä¸åŒ component</li></ul></li></ul><h2 id="Whatâ€™s-the-Kubernetes"><a href="#Whatâ€™s-the-Kubernetes" class="headerlink" title="Whatâ€™s the Kubernetes?"></a>Whatâ€™s the Kubernetes?</h2><h3 id="æ­·å²"><a href="#æ­·å²" class="headerlink" title="æ­·å²"></a>æ­·å²</h3><ol><li>Kubernetesï¼ˆåˆç¨±ç‚º k8sï¼‰æ˜¯ä¸€å€‹é–‹æ”¾åŸå§‹ç¢¼çš„ <strong>å®¹å™¨ç·¨æ’ç®¡ç†ç³»çµ± container orchestrator</strong>ï¼Œç”¨æ–¼è‡ªå‹•åŒ–æ‡‰ç”¨ç¨‹åºçš„éƒ¨ç½²ï¼Œæ“´å±•å’Œç®¡ç†ã€‚</li><li>Google æ–¼ 2014 å¹´ä¸­é¦–æ¬¡å®£å¸ƒ Kubernetes ï¼Œç¾ç”± <a href="https://www.cncf.io/">Cloud Native Computing Foundation (CNCF)</a> è² è²¬ç¶­è­·ã€‚</li><li>åŸä»¥ C++ ç·¨å¯«ï¼Œå¾Œä»¥ Golang é‡æ§‹ã€‚</li><li>ç™¼éŸ³ koo ï½ ber ï½ natisï¼Œåˆç¨±ä½œ <strong>k8s</strong>ã€‚</li></ol><h3 id="å¢é›†æ¶æ§‹"><a href="#å¢é›†æ¶æ§‹" class="headerlink" title="å¢é›†æ¶æ§‹"></a>å¢é›†æ¶æ§‹</h3><p><img src="https://i.imgur.com/g8e8Gft.png"></p><ol><li><strong>Pod</strong> æœ€åŸºæœ¬çš„éƒ¨ç½²å–®ä½ã€‚</li><li><strong>Service</strong> ä»£è¡¨ä¸€çµ„åŠŸèƒ½ç›¸åŒçš„ Pods ç¾¤é«”ã€‚è¨ªå• Service æ™‚æœƒè‡ªå‹• load balance åˆ°è©²ç¾¤é«”åº•ä¸‹ä»»æ„çš„ Pod ä¸Šã€‚</li><li><strong>Label</strong> å¯ä»¥å°‡ä»»æ„ç‰©ä»¶ <strong>è²¼ä¸Šæ¨™ç±¤</strong> ï¼Œæ–¹ä¾¿å°‡ç‰©ä»¶é€²è¡Œåˆ†çµ„é‚„æœ‰åˆ†é…ä»»å‹™</li><li><strong>Ingress</strong> ç”¨æ–¼ç®¡ç†å¾å¤–éƒ¨å°å¢é›†ä¸­çš„ <strong>Service</strong> é€²è¡Œè¨ªå•ï¼ˆHTTP, HTTPSï¼‰ã€‚å¿…é ˆéƒ¨ç½²åˆ° master node ä¸Šé¢ã€‚</li></ol><h3 id="ç³»çµ±å…ƒä»¶"><a href="#ç³»çµ±å…ƒä»¶" class="headerlink" title="ç³»çµ±å…ƒä»¶"></a>ç³»çµ±å…ƒä»¶</h3><!-- > FIXME: ingress service åœ¨å“ªå…’ï¼Ÿ --><p><img src="https://i.imgur.com/zpnOfVC.png"></p><ul><li><strong>master node</strong> : è² è²¬ç®¡ç†å’Œæ§åˆ¶æ‰€æœ‰ <strong>worker node</strong> çš„ä¸»æ©Ÿã€‚</li><li><strong>Worker node</strong> : é‹è¡Œå¾®æœå‹™çš„ä¸»æ©Ÿã€‚</li><li><strong>API server</strong> : æä¾› Kubernetes API ï¼Œè®“ä½¿ç”¨è€…å¯ä»¥é€éå®ƒç®¡ç†å’Œè¨­å®šæ•´å€‹ç³»çµ±ã€‚</li><li><strong>etcd</strong> : å„²å­˜æ•´å€‹ k8s å¢é›†ä¸­ç‰©ä»¶çš„è¦æ ¼ã€‚</li><li><strong>Scheduler</strong> : è² è²¬æ±ºå®š Pod è¦éƒ¨ç½²åˆ°å“ªä¸€å€‹ç¯€é»ä¸Šã€‚</li><li><strong>Kubelets</strong> : <strong>è¦–ç‚ºæ¯å€‹ç¯€é»çš„å¤§è…¦</strong>ã€‚<ul><li> ä½œç‚º master node å’Œ worker node æºé€šçš„åª’ä»‹ã€‚</li><li>è² è²¬ç®¡ç† Podï¼ŒåŒ…æ‹¬åœ¨ Pod ç™¼ç”Ÿæ•…éšœæ™‚å‰µå»ºæ–°çš„ Podã€‚</li></ul></li><li><strong>cAdvisor</strong> : æœé›†è©²ç¯€é»ä¸Šæ‰€æœ‰è³‡æºçš„è³‡è¨Šï¼Œé€é kubelet éš¨æ™‚å›å ±çµ¦ master nodeã€‚</li><li><strong>Kube-Proxy</strong> : ç¶­è­·ç¯€é»ä¸Šçš„ç¶²çµ¡è¦å‰‡ã€‚è² è²¬ç¶²è·¯æµé‡çš„å‚³é€ã€‚</li></ul><h3 id="ç‰¹æ€§"><a href="#ç‰¹æ€§" class="headerlink" title="ç‰¹æ€§"></a>ç‰¹æ€§</h3><ul><li><p><strong>Velocity é€Ÿåº¦</strong></p><ul><li>å¯é”æˆçŸ­æ™‚é–“å¤šæ¬¡çš„ä¸åœæ©Ÿæ›´æ–°ã€‚</li><li><img src="https://i.imgur.com/v6vg4AW.jpg" width="550" height="325" /></br></li></ul></li><li><p><strong>Immutability ä¸è®Šæ€§</strong></p><ul><li>ç•¶è»Ÿé«”ç‰ˆæœ¬æ›´æ–°æ™‚<ul><li>âœ… (<strong>immutable</strong>) é‡æ–° <strong>build</strong> ä¸€å€‹æ›´æ–°çš„ <strong>image</strong> </li><li>âŒ (<strong>mutable</strong>) é€²å…¥ <strong>container</strong> æ›´æ–° </li></ul></li></ul></li><li><p><strong>Declarative configuration å®£å‘Šå¼è¨­å®š</strong></p><ul><li><strong>å‘½ä»¤å¼å‘½ä»¤ (imperative commands)</strong> å®šç¾©äº† <strong>è¡Œç‚º</strong> ã€‚ã€ŒåŸ·è¡Œï¼¡ï¼ŒåŸ·è¡Œï¼¢ï¼Œç„¶å¾Œå†åŸ·è¡Œï¼£â€¦ã€</li><li><strong>å®£å‘Šå¼è¨­å®š (declarartive configurations)</strong> å®šç¾©äº† <strong>ç‹€æ…‹</strong> ã€‚ã€Œæˆ‘éœ€è¦ä¸‰å€‹ï¼¡ç¨‹å¼ã€</li></ul></li><li><p><strong>Self-healing è‡ªæˆ‘ä¿®å¾©</strong></p><ul><li>éš¨æ™‚ç¶­è­·ç•¶å‰æ‰€éœ€çš„ç‹€æ…‹è¨­å®šã€‚</li></ul></li><li><p><strong>Scalability æ“´å±•æ€§</strong></p><ul><li>é€šéæ–°å¢æˆ–åˆªé™¤ Pod è¼•é¬†åœ°ä¸Šä¸‹æ“´å±•æœå‹™çš„å·¥ä½œè² è¼‰ã€‚</li></ul></li></ul>]]></content>
      
      
      <categories>
          
          <category> Kubernetes </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Microservice </tag>
            
            <tag> Kubernetes </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ä½¿ç”¨ Flutter åœ¨ iOS å’Œ Android  ä¸Šè¨­å®š GoogleMap</title>
      <link href="2020/07/09/%E4%BD%BF%E7%94%A8-Flutter-%E5%9C%A8-iOS-%E5%92%8C-Android-%E4%B8%8A%E8%A8%AD%E5%AE%9A-GoogleMap/"/>
      <url>2020/07/09/%E4%BD%BF%E7%94%A8-Flutter-%E5%9C%A8-iOS-%E5%92%8C-Android-%E4%B8%8A%E8%A8%AD%E5%AE%9A-GoogleMap/</url>
      
        <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>å¦‚æœè¦åœ¨ iOS æˆ–æ˜¯ Android ä¸­ä½¿ç”¨ Google æ‰€æä¾›çš„åœ°åœ–æˆ–é“è·¯è³‡è¨Šç­‰ç­‰ï¼Œå°±å¿…é ˆè¦å–å¾— Google é…çµ¦ä½ çš„ <strong><code>API key</code></strong> ï¼Œè€Œå®ƒæ˜¯ç”¨ä¾†åœ¨æ¯æ¬¡è«‹æ±‚ Google åœ°åœ–æ™‚è®“ Google å¯ä»¥è¾¨èªå¸³æˆ¶çš„é‡‘é‘°ã€‚æ‰€ä»¥è«‹å¦¥å–„ä¿ç®¡ä½ çš„é‡‘é‘°ä¸¦ä¸”ç”±æ–¼å®‰å…¨çš„ç·£æ•…ä¸è¦åœ¨åŒä¸€å€‹é‡‘é‘°ä¸Šé¢é–‹èµ·å¤ªå¤šåŠŸèƒ½ï¼</p><span id="more"></span><h2 id="äº‹å‰æº–å‚™"><a href="#äº‹å‰æº–å‚™" class="headerlink" title="äº‹å‰æº–å‚™"></a>äº‹å‰æº–å‚™</h2><p>æ‰€æœ‰ Google çš„æœå‹™éƒ½æœƒç¶“éæ‰‹æ©Ÿå…§çš„ <strong>Google Play Services</strong> ä¾†å‚³è¼¸è³‡æ–™ã€‚æˆ‘å€‘å¯ä»¥å¾ä¸‹åœ–å¾—çŸ¥æ‡‰ç”¨ç¨‹å¼æ˜¯åªè¦ä½¿ç”¨åˆ° Google çš„æœå‹™éƒ½æœƒé€é <strong><a href="https://en.wikipedia.org/wiki/Inter-process_communication">IPC</a></strong> èˆ‡ Google Play Services åšæºé€šçš„ï¼ˆèªè­‰ã€å–å¾—è³‡è¨Šâ€¦ï¼‰</p><p><img src="https://i.imgur.com/3yZCj4y.png"></p><p>å› æ­¤è¨˜å¾—åœ¨ <strong>Android studio</strong> ä¸­å®‰è£ <strong>Google Play services</strong> ä¸ç„¶æ˜¯ç„¡æ³•å–å¾—åœ°åœ–çš„ä»»ä½•è³‡è¨Šå–”ï¼ï¼ï¼</p><p><img src="https://i.imgur.com/shqRqoM.png"></p><h2 id="Android-ç’°å¢ƒè¨­ç½®"><a href="#Android-ç’°å¢ƒè¨­ç½®" class="headerlink" title="Android ç’°å¢ƒè¨­ç½®"></a>Android ç’°å¢ƒè¨­ç½®</h2><p>è¨­å®š <code>google map</code> çš„ <strong><code>API key</code></strong> åœ¨ <code>AndroidManifest.xml</code> æª”æ¡ˆä¸­</p><p>åœ¨è©²è·¯å¾‘åº•ä¸‹ android/app/src/main/AndroidManifest.xml</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">manifest</span> <span class="attr">...</span></span></span><br><span class="line">  &lt;application ...</span><br><span class="line">    <span class="tag">&lt;<span class="name">meta-data</span> <span class="attr">android:name</span>=<span class="string">&quot;com.google.android.geo.API_KEY&quot;</span></span></span><br><span class="line"><span class="tag">               <span class="attr">android:value</span>=<span class="string">&quot;YOUR KEY HERE&quot;</span>/&gt;</span></span><br></pre></td></tr></table></figure><h2 id="iOS-ç’°å¢ƒè¨­ç½®"><a href="#iOS-ç’°å¢ƒè¨­ç½®" class="headerlink" title="iOS ç’°å¢ƒè¨­ç½®"></a>iOS ç’°å¢ƒè¨­ç½®</h2><h3 id="Step-1"><a href="#Step-1" class="headerlink" title="Step 1"></a>Step 1</h3><p>åœ¨ cmd å»ºç«‹ Flutter å°ˆæ¡ˆæ™‚æŠŠé è¨­ iOS é–‹ç™¼èªè¨€è¨­å®šæˆ swift</p><blockquote><p>flutter create -i swift &lt;å°ˆæ¡ˆåå­—&gt;</p></blockquote><h3 id="Step-2"><a href="#Step-2" class="headerlink" title="Step 2"></a>Step 2</h3><p>è¨­å®š <code>google map</code> çš„ <strong><code>API key</code></strong> åœ¨ <code>Appdelegate.swift</code> æª”æ¡ˆä¸­</p><p>åœ¨è©²è·¯å¾‘åº•ä¸‹ ios/Runner/AppDelegate.swift</p><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> UIKit</span><br><span class="line"><span class="keyword">import</span> Flutter</span><br><span class="line"><span class="keyword">import</span> GoogleMaps</span><br><span class="line"></span><br><span class="line"><span class="keyword">@UIApplicationMain</span></span><br><span class="line"><span class="keyword">@objc</span> <span class="class"><span class="keyword">class</span> <span class="title">AppDelegate</span>: <span class="title">FlutterAppDelegate</span> </span>&#123;</span><br><span class="line">  <span class="keyword">override</span> <span class="function"><span class="keyword">func</span> <span class="title">application</span>(</span></span><br><span class="line"><span class="function">    <span class="keyword">_</span> <span class="params">application</span>: <span class="type">UIApplication</span>,</span></span><br><span class="line"><span class="function">    <span class="params">didFinishLaunchingWithOptions</span> <span class="params">launchOptions</span>: [<span class="params">UIApplicationLaunchOptionsKey</span>: <span class="keyword">Any</span>]<span class="operator">?</span></span></span><br><span class="line"><span class="function">  )</span> -&gt; <span class="type">Bool</span> &#123;</span><br><span class="line">    <span class="type">GMSServices</span>.provideAPIKey(<span class="string">&quot;YOUR KEY HERE&quot;</span>)</span><br><span class="line">    <span class="type">GeneratedPluginRegistrant</span>.register(with: <span class="keyword">self</span>)</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">super</span>.application(application, didFinishLaunchingWithOptions: launchOptions)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="Step-3"><a href="#Step-3" class="headerlink" title="Step 3"></a>Step 3</h3><p>ç¢ºä¿ iOS è£ç½®å¯ä»¥æ”¯æ´åœ°åœ–æ¸²æŸ“é‚„éœ€è¦åŠ å…¥ä»¥ä¸‹è¨­å®šåœ¨è©²æª”æ¡ˆä¸­</p><p>åœ¨è©²è·¯å¾‘åº•ä¸‹ios/Runner/Info.plist</p><figure class="highlight plist"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">key</span>&gt;</span>io.flutter.embedded_views_preview<span class="tag">&lt;/<span class="name">key</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">true</span>/&gt;</span></span><br></pre></td></tr></table></figure><h3 id="å®Œæˆï¼ï¼ï¼"><a href="#å®Œæˆï¼ï¼ï¼" class="headerlink" title="å®Œæˆï¼ï¼ï¼"></a>å®Œæˆï¼ï¼ï¼</h3>]]></content>
      
      
      <categories>
          
          <category> Flutter </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Android </tag>
            
            <tag> iOS </tag>
            
            <tag> Google Map </tag>
            
            <tag> Google Play services </tag>
            
            <tag> Flutter </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æ¨æ’­é€šçŸ¥ Push Notification - æ”¹è®Šæ‰‹æ©Ÿæ‡‰ç”¨çš„æŠ€è¡“</title>
      <link href="2020/03/11/%E6%8E%A8%E6%92%AD%E9%80%9A%E7%9F%A5-Push-Notification-%E6%94%B9%E8%AE%8A%E6%89%8B%E6%A9%9F%E6%87%89%E7%94%A8%E7%9A%84%E6%8A%80%E8%A1%93/"/>
      <url>2020/03/11/%E6%8E%A8%E6%92%AD%E9%80%9A%E7%9F%A5-Push-Notification-%E6%94%B9%E8%AE%8A%E6%89%8B%E6%A9%9F%E6%87%89%E7%94%A8%E7%9A%84%E6%8A%80%E8%A1%93/</url>
      
        <content type="html"><![CDATA[<h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h1><p>ç›¸ä¿¡è¨±å¤šäººèµ·åºŠçš„ç¬¬ä¸€ä»¶äº‹å°±æ˜¯æ»‘æ»‘æ‰‹æ©Ÿçš„é€šçŸ¥ï¼Œçœ‹ä¸€ä¸‹æœ‰æ²’æœ‰æ–°çš„ email æˆ–è¨Šæ¯ï¼Œç”šè‡³æ˜¯è³¼ç‰©å¹³å°çš„ç‰¹åƒ¹æ´»å‹•ç­‰ç­‰ã€‚æœ€å¾Œå†æ±ºå®šè¦ä¸è¦æ‰“é–‹é‚£å€‹æ‡‰ç”¨ç¨‹å¼æˆ–æ˜¯ä¸€éµæ¸…é™¤ã€‚<em>æ‰€ä»¥å¦‚æœé€™é …æŠ€è¡“ä¸åœ¨æˆ‘å€‘çš„ç”Ÿæ´»ä¸­ï¼Œé‚£æˆ‘å€‘çš„æ‰‹æ©Ÿå°‡æœƒæ¯”å®‡å®™é‚„è¦å®‰éœã€‚</em> é€éä¼ºæœå™¨ä¸»å‹•ç™¼é€è¨Šæ¯åˆ°å®¢æˆ¶çš„æ‰‹æ©Ÿï¼Œè®“ä½¿ç”¨è€…å¯ä»¥åŠæ™‚åœ°ç²å¾—å„é …æœå‹™çš„è¨Šæ¯é€šçŸ¥ã€‚</p><span id="more"></span><h1 id="Firebase-Cloud-Messaging-ä»‹ç´¹"><a href="#Firebase-Cloud-Messaging-ä»‹ç´¹" class="headerlink" title="Firebase Cloud Messaging ä»‹ç´¹"></a>Firebase Cloud Messaging ä»‹ç´¹</h1><p><a href="https://firebase.google.com/docs/cloud-messaging/?gclid=CjwKCAjwmKLzBRBeEiwACCVihrLVkZCYLgGgoSq-qo4hRZP9u13ClyFbMIjpWQB234ZVU5W8YMjpmBoCOOQQAvD_BwE">Firebase Cloud Messaging</a> ç°¡ç¨± FCM ï¼Œå®ƒæ˜¯ä¸€ç¨®è·¨å¹³å°çš„æ¶ˆæ¯å‚³éè§£æ±ºæ–¹æ¡ˆï¼Œå¯ä»¥è®“æœå‹™å…è²»çš„ç™¼é€æ¶ˆæ¯ã€‚ç•¶ç„¶æ•¸é‡ä¹Ÿæœƒæœ‰ä¸€å®šçš„é™åˆ¶ã€‚æ‰€ä»¥ä»Šå¤©å°±æ˜¯è¦ä½¿ç”¨ Node.js ä¾†å¯¦ä½œ FCM ç™¼é€æ¶ˆæ¯çš„æœå‹™ã€‚</p><h1 id="åœ¨-Node-js-ä¸­é…ç½®-FCM"><a href="#åœ¨-Node-js-ä¸­é…ç½®-FCM" class="headerlink" title="åœ¨ Node.js ä¸­é…ç½® FCM"></a>åœ¨ Node.js ä¸­é…ç½® FCM</h1><h4 id="Step-1-å®‰è£å¥—ä»¶"><a href="#Step-1-å®‰è£å¥—ä»¶" class="headerlink" title="Step 1 å®‰è£å¥—ä»¶"></a>Step 1 å®‰è£å¥—ä»¶</h4><blockquote><p>npm install firebase-admin â€“save</p></blockquote><h4 id="Step-2-åœ¨å°ˆæ¡ˆä¸­å¼•å…¥è©²å¥—ä»¶"><a href="#Step-2-åœ¨å°ˆæ¡ˆä¸­å¼•å…¥è©²å¥—ä»¶" class="headerlink" title="Step 2 åœ¨å°ˆæ¡ˆä¸­å¼•å…¥è©²å¥—ä»¶"></a>Step 2 åœ¨å°ˆæ¡ˆä¸­å¼•å…¥è©²å¥—ä»¶</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> admin = <span class="built_in">require</span>(<span class="string">&#x27;firebase-admin&#x27;</span>);</span><br></pre></td></tr></table></figure><h4 id="Step-3-å‘-FCM-èªè­‰"><a href="#Step-3-å‘-FCM-èªè­‰" class="headerlink" title="Step 3 å‘ FCM èªè­‰"></a>Step 3 å‘ FCM èªè­‰</h4><p>å°‡æˆ‘å€‘çš„ FCM çš„ <a href="https://console.firebase.google.com/u/0/?pli=1">service account</a> èˆ‡æˆ‘å€‘çš„ä¼ºæœå™¨ä½œèªè­‰é€£çµ</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">admin.initializeApp(&#123;</span><br><span class="line">  credential: admin.credential.applicationDefault(),</span><br><span class="line">  databaseURL: <span class="string">&#x27;https://&lt;DATABASE_NAME&gt;.firebaseio.com&#x27;</span></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><h1 id="å‚³é€æ¨æ’­é€šçŸ¥"><a href="#å‚³é€æ¨æ’­é€šçŸ¥" class="headerlink" title="å‚³é€æ¨æ’­é€šçŸ¥"></a>å‚³é€æ¨æ’­é€šçŸ¥</h1><p><img src="https://i.imgur.com/g7f4LIz.png"></p><p>ç¶“éä»¥ä¸Šçš„æ­¥é©Ÿæˆ‘å€‘çš„ Node.js åŸºæœ¬ä¸Šå°±å¯ä»¥é–‹å§‹æ¨æ’­è¨Šæ¯çµ¦æˆ‘å€‘çš„ç”¨æˆ¶ï¼Œä½†åœ¨é€™ä¹‹å‰è«‹ç¢ºä¿æ‰‹æ©Ÿçš„ App å·²ç¶“è¨­ç½®å¥½ç›¸é—œçš„ FCM sdk ï¼Œä¸¦å°‡è©²ç”¨æˆ¶çš„ FCM token å‚³é€åˆ°å¾Œç«¯ä¸¦åŠ ä»¥å„²å­˜ã€‚é€™æ˜¯ç‚ºäº†è®“æˆ‘å€‘ä¼ºæœå™¨æœå‹™çŸ¥é“è¦æ¨æ’­é€šçŸ¥çµ¦å“ªåä½¿ç”¨è€…ã€‚</p><h3 id="å°å–®ä¸€ç‰¹å®šçš„æ‰‹æ©Ÿè£ç½®å‚³é€-messages"><a href="#å°å–®ä¸€ç‰¹å®šçš„æ‰‹æ©Ÿè£ç½®å‚³é€-messages" class="headerlink" title="å°å–®ä¸€ç‰¹å®šçš„æ‰‹æ©Ÿè£ç½®å‚³é€ messages"></a>å°å–®ä¸€ç‰¹å®šçš„æ‰‹æ©Ÿè£ç½®å‚³é€ messages</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// é€™å€‹è¨»å†Šçš„ token æ˜¯å¾æ‰‹æ©Ÿç«¯çš„ FCM SDKs å‚³ä¾†çš„.</span></span><br><span class="line"><span class="keyword">var</span> registrationToken = <span class="string">&#x27;YOUR_REGISTRATION_TOKEN&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> message = &#123;</span><br><span class="line">  data: &#123;</span><br><span class="line">    score: <span class="string">&#x27;850&#x27;</span>,</span><br><span class="line">    time: <span class="string">&#x27;2:45&#x27;</span></span><br><span class="line">  &#125;,</span><br><span class="line">  token: registrationToken</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å°é€™å€‹å·²è¨»å†Š token çš„æ‰‹æ©Ÿè£ç½®å‚³é€è¨Šæ¯</span></span><br><span class="line">admin.messaging().send(message)</span><br><span class="line">  .then(<span class="function">(<span class="params">response</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// Response æ˜¯ä¸€å€‹å­—ä¸²å‹åˆ¥çš„ message ID.</span></span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&#x27;Successfully sent message:&#x27;</span>, response);</span><br><span class="line">  &#125;)</span><br><span class="line">  .catch(<span class="function">(<span class="params">error</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&#x27;Error sending message:&#x27;</span>, error);</span><br><span class="line">  &#125;);</span><br></pre></td></tr></table></figure><h3 id="å°å¤šå€‹æ‰‹æ©Ÿè£ç½®å‚³é€-messages"><a href="#å°å¤šå€‹æ‰‹æ©Ÿè£ç½®å‚³é€-messages" class="headerlink" title="å°å¤šå€‹æ‰‹æ©Ÿè£ç½®å‚³é€ messages"></a>å°å¤šå€‹æ‰‹æ©Ÿè£ç½®å‚³é€ messages</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å¯ä»¥å»ºç«‹åŒ…å«å¤šé” 100 å€‹å·²è¨»å†Š token çš„é™£åˆ—(ä¸²åˆ—).</span></span><br><span class="line"><span class="comment">// é€™äº›å·²è¨»å†Šçš„ tokens æ‰‹æ©Ÿç«¯çš„ FCM SDKs.</span></span><br><span class="line"><span class="keyword">const</span> registrationTokens = [</span><br><span class="line">  <span class="string">&#x27;YOUR_REGISTRATION_TOKEN_1&#x27;</span>,</span><br><span class="line">  <span class="comment">// â€¦</span></span><br><span class="line">  <span class="string">&#x27;YOUR_REGISTRATION_TOKEN_N&#x27;</span>,</span><br><span class="line">];</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> message = &#123;</span><br><span class="line">  data: &#123;<span class="attr">score</span>: <span class="string">&#x27;850&#x27;</span>, <span class="attr">time</span>: <span class="string">&#x27;2:45&#x27;</span>&#125;,</span><br><span class="line">  tokens: registrationTokens,</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">admin.messaging().sendMulticast(message)</span><br><span class="line">  .then(<span class="function">(<span class="params">response</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">`<span class="subst">$&#123;response.successCount&#125;</span> messages were sent successfully`</span>);</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure><h3 id="å°å·²è¨‚é–±ç‰¹å®šä¸»é¡Œ-topics-çš„æ‰‹æ©Ÿè£ç½®å‚³é€-messages"><a href="#å°å·²è¨‚é–±ç‰¹å®šä¸»é¡Œ-topics-çš„æ‰‹æ©Ÿè£ç½®å‚³é€-messages" class="headerlink" title="å°å·²è¨‚é–±ç‰¹å®šä¸»é¡Œ topics çš„æ‰‹æ©Ÿè£ç½®å‚³é€ messages"></a>å°å·²è¨‚é–±ç‰¹å®šä¸»é¡Œ topics çš„æ‰‹æ©Ÿè£ç½®å‚³é€ messages</h3><p>åœ¨å»ºç«‹ä¸€å€‹ <code>topic</code> å¾Œï¼Œä¸æ˜¯é€éåœ¨æ‰‹æ©Ÿè£ç½®ä¸Šè¨‚é–±è©² <code>topic</code> å°±æ˜¯é€é <a href="https://firebase.google.com/docs/cloud-messaging/manage-topics?authuser=3">server API</a>.</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å¯ä»¥åœ¨ topic åå­—å‰é¢é¸æ“‡æ€§åœ°åŠ ä¸Š &quot;/topics/&quot;.</span></span><br><span class="line"><span class="keyword">var</span> topic = <span class="string">&#x27;highScores&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> message = &#123;</span><br><span class="line">  data: &#123;</span><br><span class="line">    score: <span class="string">&#x27;850&#x27;</span>,</span><br><span class="line">    time: <span class="string">&#x27;2:45&#x27;</span></span><br><span class="line">  &#125;,</span><br><span class="line">  topic: topic</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å‘å·²ç¶“è¨‚é–±è©² topic çš„æ‰‹æ©Ÿè£ç½®å‚³é€è¨Šæ¯.</span></span><br><span class="line">admin.messaging().send(message)</span><br><span class="line">  .then(<span class="function">(<span class="params">response</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// Response æ˜¯ä¸€å€‹å­—ä¸²å‹åˆ¥çš„ message ID.</span></span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&#x27;Successfully sent message:&#x27;</span>, response);</span><br><span class="line">  &#125;)</span><br><span class="line">  .catch(<span class="function">(<span class="params">error</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&#x27;Error sending message:&#x27;</span>, error);</span><br><span class="line">  &#125;);</span><br></pre></td></tr></table></figure><p>ç•¶ç„¶ä¹Ÿæœ‰ <strong>æ¢ä»¶ä¸»é¡Œ</strong> çš„åŠŸèƒ½ï¼Œè«‹æŸ¥é–± <a href="https://firebase.google.com/docs/cloud-messaging/send-message?authuser=3#send_messages_to_topics">API</a></p><h3 id="æ‰¹æ¬¡å‚³é€-messages"><a href="#æ‰¹æ¬¡å‚³é€-messages" class="headerlink" title="æ‰¹æ¬¡å‚³é€ messages"></a>æ‰¹æ¬¡å‚³é€ messages</h3><p>å¯ä»¥å°‡<strong>æœ€å¤š 100 æ¢è¨Š</strong>æ¯çµ„åˆåœ¨ä¸€èµ·ï¼Œç„¶å¾Œåœ¨ <code>API</code> å‘¼å«ä¸­å°‡ä»–å€‘ä¸€æ¬¡é€å‡ºå»ï¼Œèˆ‡æ¯æ¬¡éƒ½ç‚ºä¸€æ¢è¨Šæ¯ç™¼é€ HTTP request çš„æ•ˆèƒ½ä¸Šæœ‰é¡¯è‘—çš„æå‡. <code>e.g.</code> ç•¶ä½ éœ€è¦åŒæ™‚å‚³é€è¨Šæ¯åˆ°ä¸åŒä½¿ç”¨è€…ä¸Šï¼Œè€Œä½ ä¸»é«”çš„è¨Šæ¯å…§å®¹åªæœ‰äº›å¾®çš„å·®ç•°ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å»ºç«‹ä¸€å€‹æœ€å¤šåŒ…æ¶µ 100 æ¢è¨Šæ¯çš„é™£åˆ—(ä¸²åˆ—)ã€‚</span></span><br><span class="line"><span class="keyword">const</span> messages = [];</span><br><span class="line">messages.push(&#123;</span><br><span class="line">  notification: &#123;<span class="attr">title</span>: <span class="string">&#x27;Price drop&#x27;</span>, <span class="attr">body</span>: <span class="string">&#x27;5% off all electronics&#x27;</span>&#125;,</span><br><span class="line">  token: registrationToken,</span><br><span class="line">&#125;);</span><br><span class="line">messages.push(&#123;</span><br><span class="line">  notification: &#123;<span class="attr">title</span>: <span class="string">&#x27;Price drop&#x27;</span>, <span class="attr">body</span>: <span class="string">&#x27;2% off all books&#x27;</span>&#125;,</span><br><span class="line">  topic: <span class="string">&#x27;readers-club&#x27;</span>,</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">admin.messaging().sendAll(messages)</span><br><span class="line">  .then(<span class="function">(<span class="params">response</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(response.successCount + <span class="string">&#x27; messages were sent successfully&#x27;</span>);</span><br><span class="line">  &#125;);</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> Node.js </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Firebase Cloud Messaging </tag>
            
            <tag> Node.js </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
